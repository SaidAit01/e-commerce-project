import { defineService, implementService } from "@wix/services-definitions";
import { SignalsServiceDefinition, } from "@wix/services-definitions/core-services/signals";
export const MediaGalleryServiceDefinition = defineService("mediaGallery");
export const MediaGalleryService = implementService.withConfig()(MediaGalleryServiceDefinition, ({ getService, config }) => {
    const signalsService = getService(SignalsServiceDefinition);
    const mediaToDisplay = signalsService.signal(config?.media ?? []);
    const selectedMediaIndex = signalsService.signal(0);
    const totalMedia = signalsService.computed(() => mediaToDisplay.get().length);
    const setSelectedMediaIndex = (index) => {
        const images = mediaToDisplay.get();
        if (!images.length)
            return;
        const maxIndex = images.length - 1;
        const validIndex = Math.max(0, Math.min(index, maxIndex));
        selectedMediaIndex.set(validIndex);
    };
    const nextMedia = () => {
        const images = mediaToDisplay.get();
        const currentIndex = selectedMediaIndex.get();
        if (!images.length)
            return;
        const nextIndex = currentIndex >= images.length - 1 ? 0 : currentIndex + 1;
        selectedMediaIndex.set(nextIndex);
    };
    const previousMedia = () => {
        const images = mediaToDisplay.get();
        const currentIndex = selectedMediaIndex.get();
        if (!images.length)
            return;
        const prevIndex = currentIndex <= 0 ? images.length - 1 : currentIndex - 1;
        selectedMediaIndex.set(prevIndex);
    };
    const setMediaToDisplay = (media) => {
        mediaToDisplay.set(media);
        selectedMediaIndex.set(0);
    };
    return {
        selectedMediaIndex,
        mediaToDisplay,
        setMediaToDisplay,
        setSelectedMediaIndex,
        nextMedia,
        previousMedia,
        totalMedia,
    };
});
