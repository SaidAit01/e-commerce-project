import { createHostModule } from '@wix/sdk-runtime/host-modules';
import { createErrorHandler } from './createErrorHandler.js';
const getFromHostErrorHandlerOrDefault = (fn) => (host) => {
    if (host.getErrorHandler) {
        return fn(host.getErrorHandler());
    }
    const errorHandler = createErrorHandler(host);
    // memoize the error handler on the host
    host.getErrorHandler = () => errorHandler;
    return fn(createErrorHandler(host));
};
const errorHandler = createHostModule({
    withErrorHandler: getFromHostErrorHandlerOrDefault((e) => e.withErrorHandler),
    getResolvedError: getFromHostErrorHandlerOrDefault((e) => e.getResolvedError),
    showError: getFromHostErrorHandlerOrDefault((e) => e.showError),
    reportRetryAttempt: getFromHostErrorHandlerOrDefault((e) => e.reportRetryAttempt),
});
export const withErrorHandler = errorHandler.withErrorHandler;
export const getResolvedError = errorHandler.getResolvedError;
export const showError = errorHandler.showError;
/** @internal */
export const reportRetryAttempt = errorHandler.reportRetryAttempt;
