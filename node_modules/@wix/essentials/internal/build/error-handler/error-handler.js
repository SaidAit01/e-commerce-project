"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.reportRetryAttempt = exports.showError = exports.getResolvedError = exports.withErrorHandler = void 0;
const host_modules_1 = require("@wix/sdk-runtime/host-modules");
const createErrorHandler_js_1 = require("./createErrorHandler.js");
const getFromHostErrorHandlerOrDefault = (fn) => (host) => {
    if (host.getErrorHandler) {
        return fn(host.getErrorHandler());
    }
    const errorHandler = (0, createErrorHandler_js_1.createErrorHandler)(host);
    // memoize the error handler on the host
    host.getErrorHandler = () => errorHandler;
    return fn((0, createErrorHandler_js_1.createErrorHandler)(host));
};
const errorHandler = (0, host_modules_1.createHostModule)({
    withErrorHandler: getFromHostErrorHandlerOrDefault((e) => e.withErrorHandler),
    getResolvedError: getFromHostErrorHandlerOrDefault((e) => e.getResolvedError),
    showError: getFromHostErrorHandlerOrDefault((e) => e.showError),
    reportRetryAttempt: getFromHostErrorHandlerOrDefault((e) => e.reportRetryAttempt),
});
exports.withErrorHandler = errorHandler.withErrorHandler;
exports.getResolvedError = errorHandler.getResolvedError;
exports.showError = errorHandler.showError;
/** @internal */
exports.reportRetryAttempt = errorHandler.reportRetryAttempt;
