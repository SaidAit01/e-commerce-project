{"version":3,"names":["ErrorHandlerSdkHttpClient","constructor","httpClient","errorHandler","_defineProperty2","default","input","init","response","fetchWithAuth","handleError","requestOptions","url","URL","toString","method","e","exports"],"sources":["../../../src/testkit/SdkHttpClient.ts"],"sourcesContent":["import type { httpClient as HttpClient } from '@wix/essentials';\nimport { ErrorHandlerV2 } from '../error-handler/ErrorHandlerV2';\n\nexport class ErrorHandlerSdkHttpClient {\n  readonly httpClient;\n  readonly errorHandler;\n\n  constructor(httpClient: typeof HttpClient, errorHandler: ErrorHandlerV2) {\n    this.httpClient = httpClient;\n    this.errorHandler = errorHandler;\n  }\n\n  fetchWithAuth: typeof fetch = async (input, init) => {\n    const { httpClient, errorHandler } = this;\n    try {\n      const response = await httpClient.fetchWithAuth(input, init);\n      errorHandler.handleError(response, {\n        requestOptions: {\n          url:\n            typeof input === 'string' || input instanceof URL\n              ? input.toString()\n              : input.url,\n          method: init?.method,\n        },\n      });\n      return response;\n    } catch (e) {\n      errorHandler.handleError(e);\n      throw e;\n    }\n  };\n}\n"],"mappings":";;;;;;AAGO,MAAMA,yBAAyB,CAAC;EAIrCC,WAAWA,CAACC,WAA6B,EAAEC,aAA4B,EAAE;IAAA,IAAAC,gBAAA,CAAAC,OAAA;IAAA,IAAAD,gBAAA,CAAAC,OAAA;IAAA,IAAAD,gBAAA,CAAAC,OAAA,yBAK3C,OAAOC,KAAK,EAAEC,IAAI,KAAK;MACnD,MAAM;QAAEL,UAAU;QAAEC;MAAa,CAAC,GAAG,IAAI;MACzC,IAAI;QACF,MAAMK,QAAQ,GAAG,MAAMN,UAAU,CAACO,aAAa,CAACH,KAAK,EAAEC,IAAI,CAAC;QAC5DJ,YAAY,CAACO,WAAW,CAACF,QAAQ,EAAE;UACjCG,cAAc,EAAE;YACdC,GAAG,EACD,OAAON,KAAK,KAAK,QAAQ,IAAIA,KAAK,YAAYO,GAAG,GAC7CP,KAAK,CAACQ,QAAQ,CAAC,CAAC,GAChBR,KAAK,CAACM,GAAG;YACfG,MAAM,EAAER,IAAI,oBAAJA,IAAI,CAAEQ;UAChB;QACF,CAAC,CAAC;QACF,OAAOP,QAAQ;MACjB,CAAC,CAAC,OAAOQ,CAAC,EAAE;QACVb,YAAY,CAACO,WAAW,CAACM,CAAC,CAAC;QAC3B,MAAMA,CAAC;MACT;IACF,CAAC;IAtBC,IAAI,CAACd,UAAU,GAAGA,WAAU;IAC5B,IAAI,CAACC,YAAY,GAAGA,aAAY;EAClC;AAqBF;AAACc,OAAA,CAAAjB,yBAAA,GAAAA,yBAAA","ignoreList":[]}