{"version":3,"names":["_v","require","_withoutDefaults","reportErrorBi","errorHandler","params","_webWindow$location","errorAccessor","requestOptions","biLogger","onlineManager","webWindow","environment","biDefaultsOverrides","statusCode","errorData","errorDetails","errorMessage","exceptionMessage","httpError","errorHandlerState","config","report","withoutDefaults","httpClientErrorSrc176Evid404","artifact_id","artifactId","full_artifact_id","fullArtifactId","hostingEnvironment","app_id","artifactVersion","version","error_code","error_json","JSON","stringify","undefined","exception_message","error_message","client_error_code","clientCode","error_type","applicationError","validationError","request_id","requestId","hasInternetConnection","onLine","pageUrl","location","href","session_id","sessionId","serverUrl","url","method","entity_fqdn","entityFqdn","method_fqn","methodFqn","server_artifactid"],"sources":["../../../src/error-handler/reportErrorBi.ts"],"sourcesContent":["import { ErrorHandler } from './ErrorHandler';\nimport { httpClientErrorSrc176Evid404 } from '@wix/error-handler-core/@wix/bi-logger-os-data/v2';\nimport { ErrorAccessor } from '../state/ErrorAccessor';\nimport { withoutDefaults } from '../util/withoutDefaults';\nimport { RequestOptions } from '@wix/error-handler-core/types';\n\nexport interface ReportErrorBiParams {\n  readonly errorAccessor: ErrorAccessor;\n  readonly requestOptions: RequestOptions | undefined;\n}\n\nexport function reportErrorBi(\n  errorHandler: ErrorHandler,\n  params: ReportErrorBiParams,\n) {\n  const { errorAccessor, requestOptions } = params;\n  const {\n    biLogger,\n    onlineManager,\n    webWindow,\n    environment,\n    biDefaultsOverrides,\n  } = errorHandler;\n\n  const {\n    statusCode,\n    errorData,\n    errorDetails,\n    errorMessage,\n    exceptionMessage,\n    httpError,\n    errorHandlerState,\n  } = errorAccessor;\n\n  const config = httpError?.config;\n\n  biLogger.report(\n    withoutDefaults(httpClientErrorSrc176Evid404)({\n      artifact_id: environment.artifactId,\n      full_artifact_id: environment.fullArtifactId,\n      hostingEnvironment: biDefaultsOverrides?.hostingEnvironment,\n      app_id: biDefaultsOverrides?.app_id,\n      artifactVersion: environment.version as string | undefined,\n      error_code: statusCode,\n      error_json: errorData ? JSON.stringify(errorData) : undefined,\n      exception_message: exceptionMessage,\n      error_message: errorMessage,\n      client_error_code: errorAccessor?.clientCode,\n      error_type: errorDetails?.applicationError\n        ? 'applicationError'\n        : errorDetails?.validationError\n        ? 'validationError'\n        : undefined,\n      request_id: httpError?.requestId,\n      hasInternetConnection: onlineManager.onLine,\n      pageUrl: webWindow?.location?.href,\n      session_id: errorHandlerState?.sessionId,\n      serverUrl: config?.url || requestOptions?.url,\n      method: config?.method || requestOptions?.method || 'unknown',\n      entity_fqdn: config?.entityFqdn || requestOptions?.entityFqdn,\n      method_fqn: config?.methodFqn || requestOptions?.methodFqn,\n      server_artifactid: config?.artifactId,\n    }),\n  );\n}\n"],"mappings":";;;;AACA,IAAAA,EAAA,GAAAC,OAAA;AAEA,IAAAC,gBAAA,GAAAD,OAAA;AAQO,SAASE,aAAaA,CAC3BC,YAA0B,EAC1BC,MAA2B,EAC3B;EAAA,IAAAC,mBAAA;EACA,MAAM;IAAEC,aAAa;IAAEC;EAAe,CAAC,GAAGH,MAAM;EAChD,MAAM;IACJI,QAAQ;IACRC,aAAa;IACbC,SAAS;IACTC,WAAW;IACXC;EACF,CAAC,GAAGT,YAAY;EAEhB,MAAM;IACJU,UAAU;IACVC,SAAS;IACTC,YAAY;IACZC,YAAY;IACZC,gBAAgB;IAChBC,SAAS;IACTC;EACF,CAAC,GAAGb,aAAa;EAEjB,MAAMc,MAAM,GAAGF,SAAS,oBAATA,SAAS,CAAEE,MAAM;EAEhCZ,QAAQ,CAACa,MAAM,CACb,IAAAC,gCAAe,EAACC,+BAA4B,CAAC,CAAC;IAC5CC,WAAW,EAAEb,WAAW,CAACc,UAAU;IACnCC,gBAAgB,EAAEf,WAAW,CAACgB,cAAc;IAC5CC,kBAAkB,EAAEhB,mBAAmB,oBAAnBA,mBAAmB,CAAEgB,kBAAkB;IAC3DC,MAAM,EAAEjB,mBAAmB,oBAAnBA,mBAAmB,CAAEiB,MAAM;IACnCC,eAAe,EAAEnB,WAAW,CAACoB,OAA6B;IAC1DC,UAAU,EAAEnB,UAAU;IACtBoB,UAAU,EAAEnB,SAAS,GAAGoB,IAAI,CAACC,SAAS,CAACrB,SAAS,CAAC,GAAGsB,SAAS;IAC7DC,iBAAiB,EAAEpB,gBAAgB;IACnCqB,aAAa,EAAEtB,YAAY;IAC3BuB,iBAAiB,EAAEjC,aAAa,oBAAbA,aAAa,CAAEkC,UAAU;IAC5CC,UAAU,EAAE1B,YAAY,YAAZA,YAAY,CAAE2B,gBAAgB,GACtC,kBAAkB,GAClB3B,YAAY,YAAZA,YAAY,CAAE4B,eAAe,GAC7B,iBAAiB,GACjBP,SAAS;IACbQ,UAAU,EAAE1B,SAAS,oBAATA,SAAS,CAAE2B,SAAS;IAChCC,qBAAqB,EAAErC,aAAa,CAACsC,MAAM;IAC3CC,OAAO,EAAEtC,SAAS,aAAAL,mBAAA,GAATK,SAAS,CAAEuC,QAAQ,qBAAnB5C,mBAAA,CAAqB6C,IAAI;IAClCC,UAAU,EAAEhC,iBAAiB,oBAAjBA,iBAAiB,CAAEiC,SAAS;IACxCC,SAAS,EAAE,CAAAjC,MAAM,oBAANA,MAAM,CAAEkC,GAAG,MAAI/C,cAAc,oBAAdA,cAAc,CAAE+C,GAAG;IAC7CC,MAAM,EAAE,CAAAnC,MAAM,oBAANA,MAAM,CAAEmC,MAAM,MAAIhD,cAAc,oBAAdA,cAAc,CAAEgD,MAAM,KAAI,SAAS;IAC7DC,WAAW,EAAE,CAAApC,MAAM,oBAANA,MAAM,CAAEqC,UAAU,MAAIlD,cAAc,oBAAdA,cAAc,CAAEkD,UAAU;IAC7DC,UAAU,EAAE,CAAAtC,MAAM,oBAANA,MAAM,CAAEuC,SAAS,MAAIpD,cAAc,oBAAdA,cAAc,CAAEoD,SAAS;IAC1DC,iBAAiB,EAAExC,MAAM,oBAANA,MAAM,CAAEK;EAC7B,CAAC,CACH,CAAC;AACH","ignoreList":[]}