{"version":3,"names":["httpClientErrorSrc176Evid404","withoutDefaults","reportErrorBi","errorHandler","params","_webWindow$location","errorAccessor","requestOptions","biLogger","onlineManager","webWindow","environment","biDefaultsOverrides","statusCode","errorData","errorDetails","errorMessage","exceptionMessage","httpError","errorHandlerState","config","report","artifact_id","artifactId","full_artifact_id","fullArtifactId","hostingEnvironment","app_id","artifactVersion","version","error_code","error_json","JSON","stringify","undefined","exception_message","error_message","client_error_code","clientCode","error_type","applicationError","validationError","request_id","requestId","hasInternetConnection","onLine","pageUrl","location","href","session_id","sessionId","serverUrl","url","method","entity_fqdn","entityFqdn","method_fqn","methodFqn","server_artifactid"],"sources":["../../../src/error-handler/reportErrorBi.ts"],"sourcesContent":["import { ErrorHandler } from './ErrorHandler';\nimport { httpClientErrorSrc176Evid404 } from '@wix/error-handler-core/@wix/bi-logger-os-data/v2';\nimport { ErrorAccessor } from '../state/ErrorAccessor';\nimport { withoutDefaults } from '../util/withoutDefaults';\nimport { RequestOptions } from '@wix/error-handler-core/types';\n\nexport interface ReportErrorBiParams {\n  readonly errorAccessor: ErrorAccessor;\n  readonly requestOptions: RequestOptions | undefined;\n}\n\nexport function reportErrorBi(\n  errorHandler: ErrorHandler,\n  params: ReportErrorBiParams,\n) {\n  const { errorAccessor, requestOptions } = params;\n  const {\n    biLogger,\n    onlineManager,\n    webWindow,\n    environment,\n    biDefaultsOverrides,\n  } = errorHandler;\n\n  const {\n    statusCode,\n    errorData,\n    errorDetails,\n    errorMessage,\n    exceptionMessage,\n    httpError,\n    errorHandlerState,\n  } = errorAccessor;\n\n  const config = httpError?.config;\n\n  biLogger.report(\n    withoutDefaults(httpClientErrorSrc176Evid404)({\n      artifact_id: environment.artifactId,\n      full_artifact_id: environment.fullArtifactId,\n      hostingEnvironment: biDefaultsOverrides?.hostingEnvironment,\n      app_id: biDefaultsOverrides?.app_id,\n      artifactVersion: environment.version as string | undefined,\n      error_code: statusCode,\n      error_json: errorData ? JSON.stringify(errorData) : undefined,\n      exception_message: exceptionMessage,\n      error_message: errorMessage,\n      client_error_code: errorAccessor?.clientCode,\n      error_type: errorDetails?.applicationError\n        ? 'applicationError'\n        : errorDetails?.validationError\n        ? 'validationError'\n        : undefined,\n      request_id: httpError?.requestId,\n      hasInternetConnection: onlineManager.onLine,\n      pageUrl: webWindow?.location?.href,\n      session_id: errorHandlerState?.sessionId,\n      serverUrl: config?.url || requestOptions?.url,\n      method: config?.method || requestOptions?.method || 'unknown',\n      entity_fqdn: config?.entityFqdn || requestOptions?.entityFqdn,\n      method_fqn: config?.methodFqn || requestOptions?.methodFqn,\n      server_artifactid: config?.artifactId,\n    }),\n  );\n}\n"],"mappings":"AACA,SAASA,4BAA4B,QAAQ,mDAAmD;AAEhG,SAASC,eAAe,QAAQ,yBAAyB;AAQzD,OAAO,SAASC,aAAaA,CAC3BC,YAA0B,EAC1BC,MAA2B,EAC3B;EAAA,IAAAC,mBAAA;EACA,MAAM;IAAEC,aAAa;IAAEC;EAAe,CAAC,GAAGH,MAAM;EAChD,MAAM;IACJI,QAAQ;IACRC,aAAa;IACbC,SAAS;IACTC,WAAW;IACXC;EACF,CAAC,GAAGT,YAAY;EAEhB,MAAM;IACJU,UAAU;IACVC,SAAS;IACTC,YAAY;IACZC,YAAY;IACZC,gBAAgB;IAChBC,SAAS;IACTC;EACF,CAAC,GAAGb,aAAa;EAEjB,MAAMc,MAAM,GAAGF,SAAS,oBAATA,SAAS,CAAEE,MAAM;EAEhCZ,QAAQ,CAACa,MAAM,CACbpB,eAAe,CAACD,4BAA4B,CAAC,CAAC;IAC5CsB,WAAW,EAAEX,WAAW,CAACY,UAAU;IACnCC,gBAAgB,EAAEb,WAAW,CAACc,cAAc;IAC5CC,kBAAkB,EAAEd,mBAAmB,oBAAnBA,mBAAmB,CAAEc,kBAAkB;IAC3DC,MAAM,EAAEf,mBAAmB,oBAAnBA,mBAAmB,CAAEe,MAAM;IACnCC,eAAe,EAAEjB,WAAW,CAACkB,OAA6B;IAC1DC,UAAU,EAAEjB,UAAU;IACtBkB,UAAU,EAAEjB,SAAS,GAAGkB,IAAI,CAACC,SAAS,CAACnB,SAAS,CAAC,GAAGoB,SAAS;IAC7DC,iBAAiB,EAAElB,gBAAgB;IACnCmB,aAAa,EAAEpB,YAAY;IAC3BqB,iBAAiB,EAAE/B,aAAa,oBAAbA,aAAa,CAAEgC,UAAU;IAC5CC,UAAU,EAAExB,YAAY,YAAZA,YAAY,CAAEyB,gBAAgB,GACtC,kBAAkB,GAClBzB,YAAY,YAAZA,YAAY,CAAE0B,eAAe,GAC7B,iBAAiB,GACjBP,SAAS;IACbQ,UAAU,EAAExB,SAAS,oBAATA,SAAS,CAAEyB,SAAS;IAChCC,qBAAqB,EAAEnC,aAAa,CAACoC,MAAM;IAC3CC,OAAO,EAAEpC,SAAS,aAAAL,mBAAA,GAATK,SAAS,CAAEqC,QAAQ,qBAAnB1C,mBAAA,CAAqB2C,IAAI;IAClCC,UAAU,EAAE9B,iBAAiB,oBAAjBA,iBAAiB,CAAE+B,SAAS;IACxCC,SAAS,EAAE,CAAA/B,MAAM,oBAANA,MAAM,CAAEgC,GAAG,MAAI7C,cAAc,oBAAdA,cAAc,CAAE6C,GAAG;IAC7CC,MAAM,EAAE,CAAAjC,MAAM,oBAANA,MAAM,CAAEiC,MAAM,MAAI9C,cAAc,oBAAdA,cAAc,CAAE8C,MAAM,KAAI,SAAS;IAC7DC,WAAW,EAAE,CAAAlC,MAAM,oBAANA,MAAM,CAAEmC,UAAU,MAAIhD,cAAc,oBAAdA,cAAc,CAAEgD,UAAU;IAC7DC,UAAU,EAAE,CAAApC,MAAM,oBAANA,MAAM,CAAEqC,SAAS,MAAIlD,cAAc,oBAAdA,cAAc,CAAEkD,SAAS;IAC1DC,iBAAiB,EAAEtC,MAAM,oBAANA,MAAM,CAAEG;EAC7B,CAAC,CACH,CAAC;AACH","ignoreList":[]}