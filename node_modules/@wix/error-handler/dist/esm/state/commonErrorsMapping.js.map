{"version":3,"names":["createCommonErrorsMapping","t","state","webWindow","location","applicationError","CAPTCHA_REQUIRED","message","statusCodeError","UNAUTHENTICATED","action","text","onClick","url","URL","searchParams","set","window","href","open","undefined","INVALID_ARGUMENT","PERMISSION_DENIED","NOT_FOUND","ALREADY_EXISTS","reload","UNAVAILABLE","RESOURCE_EXHAUSTED","BAD_GATEWAY","GATEWAY_TIMEOUT","INTERNAL","getConnectionErrorShowErrorProps","getDefaultErrorShowErrorProps","createGetNetworkErrorShowErrorProps","errorAccessor","_errorAccessor$except","lcExceptionMessage","exceptionMessage","toLowerCase","setCommonErrors","translations","errorMonitor","getTranslateFn","commonErrors","commonErrorsMap","connectionErrorShowErrorProps","defaultErrorShowErrorProps","getNetworkErrorShowErrorProps","e","captureException"],"sources":["../../../src/state/commonErrorsMapping.ts"],"sourcesContent":["import { Translate } from '../services/translations';\nimport { ErrorCodesMap, ShowErrorProps } from '@wix/error-handler-core/types';\nimport { CommonErrorsMapState } from './CommonErrorsMapState';\nimport { ErrorAccessor } from './ErrorAccessor';\n\nexport function createCommonErrorsMapping(\n  t: Translate,\n  state: CommonErrorsMapState,\n): ErrorCodesMap {\n  const { webWindow } = state;\n\n  const location = webWindow?.location;\n\n  return {\n    applicationError: {\n      CAPTCHA_REQUIRED: () => ({\n        message: t('errorHandler.common-error.captchaRequired'),\n      }),\n    },\n    statusCodeError: {\n      UNAUTHENTICATED: () => ({\n        message: t('errorHandler.common-error.unauthenticated'),\n        action: webWindow\n          ? {\n              text: t('errorHandler.common-error.unauthenticated.cta'),\n              onClick: () => {\n                const url = new URL('https://users.wix.com/signin');\n                url.searchParams.set('redirectTo', window.location.href);\n                webWindow.open?.(url.href, '_blank');\n              },\n            }\n          : undefined,\n      }),\n      INVALID_ARGUMENT: () => ({\n        message: t('errorHandler.common-error.validationBasic'),\n      }),\n      PERMISSION_DENIED: () => ({\n        message: t('errorHandler.common-error.permission-denied.site'),\n      }),\n      NOT_FOUND: () => ({\n        message: t('errorHandler.common-error.not-found'),\n      }),\n      ALREADY_EXISTS: () => ({\n        message: t('errorHandler.common-error.conflict'),\n        action: location\n          ? {\n              text: t('errorHandler.common-error.refresh.cta'),\n              onClick: () => {\n                location.reload();\n              },\n            }\n          : undefined,\n      }),\n      UNAVAILABLE: () => ({\n        message: t('errorHandler.common-error.technicalIssue'),\n      }),\n      RESOURCE_EXHAUSTED: () => ({\n        message: t('errorHandler.common-error.resource-exhausted'),\n      }),\n      BAD_GATEWAY: () => ({\n        message: t('errorHandler.common-error.technicalIssue'),\n      }),\n      GATEWAY_TIMEOUT: () => ({\n        message: t('errorHandler.common-error.technicalIssue'),\n      }),\n      INTERNAL: () => ({\n        message: t('errorHandler.common-error.technicalIssue'),\n      }),\n    },\n  };\n}\n\nexport function getConnectionErrorShowErrorProps(t: Translate): ShowErrorProps {\n  return {\n    message: t('errorHandler.common-error.noConnection'),\n  };\n}\n\nexport function getDefaultErrorShowErrorProps(t: Translate): ShowErrorProps {\n  return {\n    message: t('errorHandler.common-error.technicalIssue'),\n  };\n}\n\nexport function createGetNetworkErrorShowErrorProps(t: Translate) {\n  return (errorAccessor: ErrorAccessor) => {\n    const lcExceptionMessage = errorAccessor.exceptionMessage?.toLowerCase();\n\n    if (lcExceptionMessage === 'network error') {\n      return {\n        message: t('errorHandler.common-error.networkError'),\n      };\n    }\n\n    if (\n      lcExceptionMessage === 'request aborted' ||\n      lcExceptionMessage === 'timeout exceeded'\n    ) {\n      return {\n        message: t('errorHandler.common-error.technicalIssue.generic'),\n      };\n    }\n\n    return {\n      message: t('errorHandler.common-error.technicalIssue-unmappedError'),\n    };\n  };\n}\n\nexport async function setCommonErrors(state: CommonErrorsMapState) {\n  const { translations, errorMonitor } = state;\n\n  try {\n    const t = await translations.getTranslateFn();\n\n    state.commonErrors = {\n      commonErrorsMap: createCommonErrorsMapping(t, state),\n      connectionErrorShowErrorProps: getConnectionErrorShowErrorProps(t),\n      defaultErrorShowErrorProps: getDefaultErrorShowErrorProps(t),\n      getNetworkErrorShowErrorProps: createGetNetworkErrorShowErrorProps(t),\n    };\n  } catch (e) {\n    errorMonitor.captureException(e as Error);\n  }\n}\n"],"mappings":"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","ignoreList":[]}