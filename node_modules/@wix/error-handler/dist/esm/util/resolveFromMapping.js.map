{"version":3,"names":["statusCodeNumericToText","resolveFromMapping","params","errorAccessor","errorCodesMap","applicationError","statusCode","error","validationError","_errorCodesMap$applic","code","applicationErrorMapping","_validationError$fiel","rules","Object","keys","firstValidationError","fieldViolations","find","_ref","ruleName","includes","_errorCodesMap$valida","validationErrorMapping","statusCodeText","statusCodeErrorMap","serverError","INTERNAL","NOT_IMPLEMENTED","BAD_GATEWAY","UNAVAILABLE","statusCodeError","statusCodeErrorMappingFunction"],"sources":["../../../src/util/resolveFromMapping.ts"],"sourcesContent":["import { statusCodeNumericToText } from './statusCodeNumericToText';\nimport { ErrorAccessor } from '../state/ErrorAccessor';\nimport {\n  ErrorCodesMap,\n  StatusCodeMap,\n  ShowErrorProps,\n} from '@wix/error-handler-core/types';\n\nexport interface ResolveFromMappingParams {\n  readonly errorAccessor: ErrorAccessor;\n  readonly errorCodesMap: ErrorCodesMap;\n}\n\nexport function resolveFromMapping(\n  params: ResolveFromMappingParams,\n): ShowErrorProps | null | undefined {\n  const { errorAccessor, errorCodesMap } = params;\n\n  const { applicationError, statusCode, error, validationError } =\n    errorAccessor;\n\n  if (applicationError) {\n    const { code } = applicationError;\n    const applicationErrorMapping =\n      errorCodesMap.applicationError?.[code as string];\n\n    if (applicationErrorMapping === false) {\n      return null;\n    }\n\n    if (applicationErrorMapping) {\n      return applicationErrorMapping(applicationError, error);\n    }\n  }\n\n  if (errorCodesMap.validationError) {\n    const rules = Object.keys(errorCodesMap.validationError);\n    const firstValidationError = validationError?.fieldViolations?.find(\n      ({ ruleName }) => rules.includes(ruleName as string),\n    );\n\n    if (firstValidationError?.ruleName) {\n      const validationErrorMapping =\n        errorCodesMap.validationError?.[firstValidationError.ruleName];\n\n      if (validationErrorMapping) {\n        return validationErrorMapping(error);\n      }\n    }\n  }\n\n  const statusCodeText =\n    statusCode != null ? statusCodeNumericToText[statusCode] : null;\n\n  const statusCodeErrorMap: StatusCodeMap = {\n    ...(errorCodesMap.serverError\n      ? {\n          INTERNAL: errorCodesMap.serverError,\n          NOT_IMPLEMENTED: errorCodesMap.serverError,\n          BAD_GATEWAY: errorCodesMap.serverError,\n          UNAVAILABLE: errorCodesMap.serverError,\n        }\n      : {}),\n    ...errorCodesMap.statusCodeError,\n  };\n\n  const statusCodeErrorMappingFunction =\n    statusCodeText != null ? statusCodeErrorMap[statusCodeText] : null;\n\n  if (statusCodeErrorMappingFunction) {\n    return statusCodeErrorMappingFunction(error);\n  }\n\n  return null;\n}\n"],"mappings":"AAAA,SAASA,uBAAuB,QAAQ,2BAA2B;AAanE,OAAO,SAASC,kBAAkBA,CAChCC,MAAgC,EACG;EACnC,MAAM;IAAEC,aAAa;IAAEC;EAAc,CAAC,GAAGF,MAAM;EAE/C,MAAM;IAAEG,gBAAgB;IAAEC,UAAU;IAAEC,KAAK;IAAEC;EAAgB,CAAC,GAC5DL,aAAa;EAEf,IAAIE,gBAAgB,EAAE;IAAA,IAAAI,qBAAA;IACpB,MAAM;MAAEC;IAAK,CAAC,GAAGL,gBAAgB;IACjC,MAAMM,uBAAuB,IAAAF,qBAAA,GAC3BL,aAAa,CAACC,gBAAgB,qBAA9BI,qBAAA,CAAiCC,IAAI,CAAW;IAElD,IAAIC,uBAAuB,KAAK,KAAK,EAAE;MACrC,OAAO,IAAI;IACb;IAEA,IAAIA,uBAAuB,EAAE;MAC3B,OAAOA,uBAAuB,CAACN,gBAAgB,EAAEE,KAAK,CAAC;IACzD;EACF;EAEA,IAAIH,aAAa,CAACI,eAAe,EAAE;IAAA,IAAAI,qBAAA;IACjC,MAAMC,KAAK,GAAGC,MAAM,CAACC,IAAI,CAACX,aAAa,CAACI,eAAe,CAAC;IACxD,MAAMQ,oBAAoB,GAAGR,eAAe,aAAAI,qBAAA,GAAfJ,eAAe,CAAES,eAAe,qBAAhCL,qBAAA,CAAkCM,IAAI,CACjEC,IAAA;MAAA,IAAC;QAAEC;MAAS,CAAC,GAAAD,IAAA;MAAA,OAAKN,KAAK,CAACQ,QAAQ,CAACD,QAAkB,CAAC;IAAA,CACtD,CAAC;IAED,IAAIJ,oBAAoB,YAApBA,oBAAoB,CAAEI,QAAQ,EAAE;MAAA,IAAAE,qBAAA;MAClC,MAAMC,sBAAsB,IAAAD,qBAAA,GAC1BlB,aAAa,CAACI,eAAe,qBAA7Bc,qBAAA,CAAgCN,oBAAoB,CAACI,QAAQ,CAAC;MAEhE,IAAIG,sBAAsB,EAAE;QAC1B,OAAOA,sBAAsB,CAAChB,KAAK,CAAC;MACtC;IACF;EACF;EAEA,MAAMiB,cAAc,GAClBlB,UAAU,IAAI,IAAI,GAAGN,uBAAuB,CAACM,UAAU,CAAC,GAAG,IAAI;EAEjE,MAAMmB,kBAAiC,GAAG;IACxC,IAAIrB,aAAa,CAACsB,WAAW,GACzB;MACEC,QAAQ,EAAEvB,aAAa,CAACsB,WAAW;MACnCE,eAAe,EAAExB,aAAa,CAACsB,WAAW;MAC1CG,WAAW,EAAEzB,aAAa,CAACsB,WAAW;MACtCI,WAAW,EAAE1B,aAAa,CAACsB;IAC7B,CAAC,GACD,CAAC,CAAC,CAAC;IACP,GAAGtB,aAAa,CAAC2B;EACnB,CAAC;EAED,MAAMC,8BAA8B,GAClCR,cAAc,IAAI,IAAI,GAAGC,kBAAkB,CAACD,cAAc,CAAC,GAAG,IAAI;EAEpE,IAAIQ,8BAA8B,EAAE;IAClC,OAAOA,8BAA8B,CAACzB,KAAK,CAAC;EAC9C;EAEA,OAAO,IAAI;AACb","ignoreList":[]}