import { defineService, implementService } from "@wix/services-definitions";
import { SignalsServiceDefinition, } from "@wix/services-definitions/core-services/signals";
import { URLParamsUtils } from "../utils/url-params.js";
import { SortType, DEFAULT_SORT_TYPE } from "../enums/sort-enums.js";
export const SortServiceDefinition = defineService("sort");
export const defaultSort = DEFAULT_SORT_TYPE;
export const SortService = implementService.withConfig()(SortServiceDefinition, ({ getService, config }) => {
    const signalsService = getService(SignalsServiceDefinition);
    const currentSort = signalsService.signal((config?.initialSort || defaultSort));
    const setSortBy = async (sortBy) => {
        currentSort.set(sortBy);
        // Update URL with sort parameter
        const currentParams = URLParamsUtils.getURLParams();
        const urlParams = { ...currentParams };
        if (sortBy !== SortType.NEWEST) {
            urlParams["sort"] = sortBy;
        }
        else {
            delete urlParams["sort"];
        }
        URLParamsUtils.updateURL(urlParams);
    };
    return {
        currentSort,
        setSortBy,
    };
});
